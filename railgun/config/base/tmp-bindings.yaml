apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: leader-election-rolebinding
subjects:
- kind: ServiceAccount
  name: kong-serviceaccount
  namespace: kong
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: manager-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: manager-role
subjects:
- kind: ServiceAccount
  name: kong-serviceaccount
  namespace: kong
# TODO apparently you cannot patch namespaces or this isn't the way to do it.
# Using this results in:
# Error: no matches for Id rbac.authorization.k8s.io_v1_Role|kong|leader-election-role; failed to find unique target for patch rbac.authorization.k8s.io_v1_Role|leader-election-role
# So either we accept that kustomization.yaml includes "namespace: kong" (which overwrites the namespace for everything--this is fine for what we need AFAIK)
# or we generate this resource with the expected namespace already.
#---
#apiVersion: rbac.authorization.k8s.io/v1
#kind: Role
#metadata:
#  name: leader-election-role
#  namespace: kong
